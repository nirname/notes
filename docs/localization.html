<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>localization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #ffffff;
        color: #a0a0a0;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b; background-color: #ffffff; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #1f1c1b; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="github-markdown.css" />
</head>
<body>
<p><a href="index.html">На главную</a></p>
<h1 id="локализация">Локализация</h1>
<p>Вы делаете продукт для другой страны другой страны на существующей платформе.</p>
<p>Очевидно, что локализация ≠ перевод.</p>
<p>Что же туда входит.</p>
<h2 id="перевод-текстов-сайта">Перевод текстов сайта</h2>
<p>Автоматические системы перевода сейчас (2022 год) уже довольно хороши, но всё ещё недостаточно хороши для многих восточных языков ввиду другого порядка слов в них.</p>
<p>Для качественного перевода вам нужен переводчик, а финальные текты придётся вычитать с носителем языка.</p>
<p>Допустим, вы благополучно перевели весь статичный текст на сайте. Переводчик перевёл страницу, а верстальщик вставил новые тексты на сайт.</p>
<p>Если страница целиком статическая, то проще всего её скопировать (<code>index.html.ru -&gt; index.html.en</code>) и поправить текст прямо в html.</p>
<p>В остальных местах нужно сделать так, чтобы текст на страницах менялся в зависимости от выбранного языка. Это довольно трудозатратная часть, если сайт не был рассчитан на поддержку нескольких языков. Вам придётся либо править эти места вручную, либо попытаться обойти html каким-либо парсером и заменить жёстко зашитый текст на переменные.</p>
<p>В системе, динамические тексты, как правило, состоят из пар “ключ-значение”, где значение представляет собой шаблон:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="fu">hello</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;Hello, %{username}&quot;</span></span></code></pre></div>
<p>А в самом html у вас будет ещё одна интерполяция:</p>
<pre><code>{{ translate(&#39;hello&#39;, {username: &quot;John&quot;}) }}</code></pre>
<p>Это условный пример, шаблонизация будет варьироваться в зависимости от инструмента (j2, mustache, erb, slim).</p>
<p>Для разных языков эти шаблоны, разумеется, будут отличаться.</p>
<p>Также в текстах будут разные окончания, когда вам нужно указать количество: 1 молоток, 2 молотка, 5 молотков.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="fu">hammer</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="at">  </span><span class="fu">one</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;У вас %{count} молоток&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="st">  two: &quot;</span><span class="er">У</span><span class="at"> </span><span class="er">вас</span><span class="at"> </span><span class="er">%{count}</span><span class="at"> </span><span class="er">молотка&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="at">  </span><span class="fu">many</span><span class="kw">:</span><span class="at"> </span><span class="st">&quot;У вас %{count} молотков&quot;</span></span></code></pre></div>
<h2 id="как-править-править-тексты">Как править править тексты?</h2>
<h3 id="yaml">YAML</h3>
<p>Ваши шаблоны для переводов могут храниться в YAML. Грамотно править YAML или любой другой структурированный формат сможет только разработчик, который использует редактор с подстветкой синтаксиса, авто-форматирование и прочие вещи. Строгую YAML разметку обыватель сломает. Не разработчики открывшие YAML через блокнот сломают вам кодировку. Шаблонизация также накладывает строгие требования.</p>
<p>Предоставить переводчику код не получится. Как следствие, массовый перевод всех текстов здесь практически невозможен. Внесение отдельных правок по указанию переводчика возможно, но данные наверняка будут разбиты на отдельные файлы, из-за чего это окажется весьма трудозатратно.</p>
<h3 id="выгрузка-загрузка">Выгрузка-загрузка</h3>
<p>Разумеется, вы можете хранить тексты где-то отдельно, и даже не в коде, а например в базе данных. Будь то Redis или Postgres. В любом случае, для переводчиков лучше подготовить для выгрузку в XLS. А также обратную загрузку из XLS (в YAML, Redis, Postgres) с определённой валидацией. При массовом переводе выгруженных текстов (Excel или в любой другой выгрузке) потеряется контекст. Так как то, что будет выгружено - это пара “ключ-перевод/шаблон” для каждого конкретного языка. И для переводчика, они никак не привязаны к тому месту, где они размещены на сайте. Это косвенно можно сделать по ключу, но где встречается тот или иной текст точно может сказать только разработчик. Если ваши тексты состоят из каких-то небольших фрагметнов, это ещё сильнее уменьшит контекст и добавит сложности.</p>
<h3 id="inline-in-place-редактирование">Inline / In-place редактирование</h3>
<p>Можно воспользоваться также inline-редактированием. Для этого вам придётся прикрутить к вашему сайту некие инструменты, которые позволяют нажать на определённое слово на сайте, исправить его и сохранить результат. Подробного обзора на такие инструменты здесь не будет, т.к. это всё сильно зависит от выбранных технологий. И даже с таким редактированием придётся плотно взаимодействовать с переводчиком, потому что он не будет знать всех пользовательских сценариев на сайте. Часть текстов будет просто пропущена. Зато внесение отдельных точечных правок здесь оказывается довольно простым. Кроме того и разработчик и переводчик будут одновременно видеть самую свежую информацию.</p>
<h3 id="сторонние-сервисы">Сторонние сервисы</h3>
<p>Можно воспользоваться некими сервисами, которые предполагают, что ваши тексты уже лежат в YAML, или другом структурированном формате. Вы выгружаете данные им, они переводят, и вы можете загрузить их обратно.</p>
<p>Качество и скорость перевода и обратная связь будут зависеть от сервиса и специалистов в нём работающих.</p>
<h3 id="сравнение">Сравнение</h3>
<p>Исключением из некоторых случаев будет только разработчик и переводчик в одном лице. При этом он должен являться носителем языка или знать язык на достаточном уровне. Поиск таких специалистов для многих компаний будет нецелесообразен.</p>
<p>Поэтому редактировани сложных интерполяций всегда останется проблемой, т.к. разработчик не знает языка, а переводчик не знает языка шаблонизации. Конечно, его можно освоить, но периодически будут случаться поломки.</p>
<p>Важный элемент. Все варианты в которых разработчик и переводчик не работают синхронно, страдают от отсутствия обратной связи. Часто требуется узнать, какие ключи где используются, где остались не переведнные тексты и/или какие тексты недоступны для перевода (по тем или иным причинам).</p>
<p>Соберём воедино разные варианты:</p>
<table>
<thead>
<tr class="header">
<th>Плюсы</th>
<th>YAML</th>
<th>XLS</th>
<th>INLINE</th>
<th>EXTERNAL SERVICE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Лёгкость внедрения</td>
<td>+</td>
<td>+/−</td>
<td>−</td>
<td>+/−</td>
</tr>
<tr class="even">
<td>Наличие контекста</td>
<td>−</td>
<td>−</td>
<td>+</td>
<td>?</td>
</tr>
<tr class="odd">
<td>Отсутствие спец. разметки</td>
<td>−</td>
<td>+</td>
<td>+</td>
<td>+</td>
</tr>
<tr class="even">
<td>Массовый перевод</td>
<td>+/−</td>
<td>+</td>
<td>−</td>
<td>+</td>
</tr>
<tr class="odd">
<td>Внесение отдельных правок</td>
<td>−</td>
<td>−</td>
<td>+</td>
<td>−</td>
</tr>
<tr class="even">
<td>Редактирование интерполяции</td>
<td>+/−</td>
<td>+/−</td>
<td>+/−</td>
<td>?</td>
</tr>
<tr class="odd">
<td>Синхронность перевода и разработки</td>
<td>−</td>
<td>−</td>
<td>+</td>
<td>?</td>
</tr>
</tbody>
</table>
<h2 id="вёрстка">Вёрстка</h2>
<p>Часть веб-сайта просто разъедется из-за разной длины слов в разных языках. (например в китайском), поэтому вам придётся подогнать и стили.</p>
<p>html:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">&lt;body</span><span class="ot"> lang=</span><span class="st">&#39;ru&#39;</span><span class="kw">&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">&lt;/body&gt;</span></span></code></pre></div>
<p>css:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>body<span class="fu">.ru</span> {}</span></code></pre></div>
<p>Отдельно стоит упомянуть языки с написанием справа-налево.</p>
<h2 id="региональные-особенности">Региональные особенности</h2>
<p>Также будут отличаться:</p>
<ul>
<li><p>Форматы дат и времени</p>
<p>Их может форматировать браузер ну или сервер если вы используете SSR. Если это проект для конкретной страны, то это может быть настройка всего проекта. Если это международный и у вас SSR вам надо пробросить информацию о том, где находится пользователь, на back.</p></li>
<li><p>Начало недели</p>
<p>Учитывайте, если где-то на сайте есть календарь</p></li>
<li><p>Часовые пояса</p>
<p>Когда пользователи в разных концах света иногда вам нужно знать в какой временной зоне они находятся. При этом это не географическое значение, возможет переход на летнее и зимнее время, а точность может быть указана до 15 минут.</p></li>
<li><p>Различные выходные дни и праздники</p></li>
<li><p>Суеверия</p>
<p>4 в Китае не счастливое число. Помните об этом, если вы высылаете пользователю любые коды (подтверждения).</p></li>
</ul>
<h2 id="тексты-рассылок">Тексты рассылок</h2>
<p>Как правило, шаблоны для рассылки писем лежат где-то отдельно в почтовой системе. И их текст не лежит в back или front приложении.</p>
<h2 id="пользовательские-соглашения">Пользовательские соглашения</h2>
<p>Переделайте пользовательские соглашения таким образом, чтобы они подходидили под законодательство конкретной страны.</p>
<h2 id="content">Content</h2>
<p>Проверяйте смысловое наполнение.</p>
<p>Допустим, вы составили задачу:</p>
<blockquote>
<p>Один огурец стоит 15 рублей. Сколько будут стоить 4 огурца?</p>
</blockquote>
<p>Если в такой задаче поменять валюту, напрмер на доллары, то теряется здравый смысл.</p>
<blockquote>
<p>Огурец стоит 15 долларов.</p>
</blockquote>
<p>Возможно где-то он столько и стоит. Но в моменте информация оказывается искажена. Если вслед за этим поменять и цену, меняется методическая часть задачи.</p>
<blockquote>
<p>Огурец стоит 30 центов. Сколько будут стоить 4 огурца?</p>
</blockquote>
<p>Мы хотели задавать задания по умножению двузначных чисел, а в итоге оказались либо в дробях (0.3 доллара), либо вообще в других единицах измерения (центы), либо появились трёхзначные числа.</p>
<p>Можно заменить огурец на другой овощ или фрукт который отразит желаемое. И поменять соответствующие картинки, если таковые имеются.</p>
<h2 id="знакомые-нужные-вещи">Знакомые <del>нужные</del> вещи</h2>
<blockquote>
<p>Сразу расшифрую - это отсылка к роману Кинга “Нужные вещи”</p>
</blockquote>
<p>Всё, что пользователь видит на сайте, должно быть ему знакомо. А именно:</p>
<ul>
<li><p>Топонимы</p>
<p>Если вы упоминаете названия мест (в качестве примера) где-то в тексте, не забудьте их заменить. Разумеется, учебник по Географии должен оставаться таковым.</p></li>
<li><p>Расстояния</p>
<p>Если в качестве сравнения вы привели фразу “как расстояние от Петербурга до Москвы”, помните, что люди где-нибудь в Канаде не знают сколько это. Подберите аналог.</p></li>
<li><p>Блюда</p>
<p>Упоминание незнакомых блюд тоже вызовет диссонас. Замените это на что-то понятное. Если вы, конечно, не делаете сайт для ресторана.</p></li>
<li><p>Предметы</p>
<p>Некоторые дети, например, в Китае, не знают что такое юла. Там не распространена такая игрушка.</p></li>
</ul>
<h2 id="изображения">Изображения</h2>
<p>Придётся поменять многие картинки на сайте, если они изображают людей и/или предметы таким образом, чтобы изображения были интернациональны, а предметы знакомы.</p>
<p>Будет странно в европейском продукте изображать пользователей азиатами. И речь вовсе не идёт про политкорректность. Подбирайте фото так, чтобы люди могли найти там себя.</p>
<p>Отдельно стоит обсудить рисованые и/или стилизованные изображения. Например, если вы захотите нарисовать японца, то лучше подойдёт “аниме” стиль, нежели буквальное изображение действительности.</p>
<h2 id="озвучивание">Озвучивание</h2>
<p>Если на сайте есть любого рода озвучивание (да, такие сайты существуют), вам придётся перезаписать и его, лучше всего с носителями языка во избежание акцента. Разумеется, это касается игр и любых других приложений, включающих озвучивание, содержащее речь.</p>
<h2 id="анимация">Анимация</h2>
<p>Да, здесь идёт речь в основном про web-разработку, а не про игры. Но если у вас есть анимация персонажей, то озвучивание или просто текстовые реплики должны соответствовать анимации.</p>
<p>Длина текстов может отличаться не только визуально (из-за написания), но и сами реплики будут различны. Либо ваша анимация, либо ваши тексты должны быть переделаны таким образом, чтобы вы успевали сказать всё что хотите в озвучивании а пользователь успевал прочесть всё, что появляется на экране.</p>
<h2 id="адреса">Адреса</h2>
<p>Вы внедрили КЛАДР (уже не поддерживается) или ФИАС на сайте, рассчитанном на российскую аудиторию. Придется внедрить что-то другое. Глобальные адресные системы очень часто не полные. Специальные системы и/или базы внутри страны тоже грешат, но меньше.</p>
<h2 id="платёжные-системы">Платёжные системы</h2>
<p>У вас будет интеграция с другой платёжной системой, даже если ваша универсальная. То, что использовать, будет диктовать ваша аудитория, т.к. распределение использования платёжных систем в разных странах разное. А также у разных систем разная комисия.</p>
<p>Лично я сталкивался с xsolla, cloudpayments, stripe, alipay. Из перечисленных, у alipay самая жуткая документация и самая сложная интеграция. У stripe очень хорошая и приятная. Также очень хорош cloudpayments. xsolla чуть менее прозрачная.</p>
<h2 id="поля-при-регистрации">Поля при регистрации</h2>
<p>В зависимости от законодательства, или данных которые вы захотите собирать, аудитории на которую рассчитан сайт, у вас будет разный состав полей.</p>
<p>Если на сайте регистрируется компания, то надо отразить многие юридические моменты. Например - адрес компании.</p>
<p>Если частное лицо занято в определённой профессии, тут тоже могут быть свои нюансы. Например в Бразилии каждый преподаватель имеет свой код, своеобразную лицензицю.</p>
<p>От страны к стране могут варьироваться возрастные ограничения, и если при регистрации вы просите указать email, то имейте в виду, что может потребоваться предоставить и родительское согласие, если сайт ориентирован на детей. А также указывать родительский email при оплате, т.к. вы будете обязаны куда-то отправить электронный чек.</p>
<p>Разумеется, будет отличаться валидация.</p>
<p>Кроме того может отличаться порядок полей, например ФИО.</p>
<h2 id="другие-способы-аутентификации-и-платежей">Другие способы аутентификации (и платежей)</h2>
<p>Даже если при наличии OAuth может оказаться всё не так универсально. Посмотрите на локальные мессенджеры/системы для каждой конкретной страны, нарпример WeСhat для китайского сектора.</p>
<h2 id="домен">Домен</h2>
<p>Возможно вы зарегистрируете новый домен. Превращение <code>example.com -&gt; example.org</code> может оказаться не самым удачным. Выберите что-нибудь благозвучное для указанного региона.</p>
<h2 id="cdn">CDN</h2>
<p>Снова скажу очевидную вещь. Размещайте сервера ближе к получателю. Настраивайте CDN для статичного контента. Настраивайте реплику базы данных для чтения. Или размещайте всю базу, если возможно, в целевом регионе. Сайт размещённый на серверах в России будет открываться в Южной Америке в три раза дольше. Проверено.</p>
<p><a href="index.html">На главную</a></p>
</body>
</html>
